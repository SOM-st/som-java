# -*- mode: yaml -*-
# Config file for ReBench
default_experiment: all
default_data_file: 'rebench.data'

reporting:
    # Benchmark results will be reported to ReBenchDB
    rebenchdb:
        # this url needs to point to the API endpoint
        db_url: https://rebench.stefan-marr.de/rebenchdb/results
        repo_url: https://github.com/sophie-kaleba/som-java
        record_all: true # make sure everything is recorded
        project_name: grSOM

runs:
    min_iteration_time: 5
    max_invocation_time: 6000

benchmark_suites:
    macro-startup:
        gauge_adapter: RebenchLog
        command: &MACRO_CMD "Examples/Benchmarks/BenchmarkHarness.som %(benchmark)s"
        invocations: 3
        benchmarks:
            - Richards:
                extra_args: "1 0 1"
            - DeltaBlue:
                extra_args: "1 0 1000"
            - NBody:
                extra_args: "1 0 30000"
            - JsonSmall:
                extra_args: "1 0 80"
            - GraphSearch:
                extra_args: "1 0 30"
            - PageRank:
                extra_args: "1 0 1400"
                

    macro-steady:
        gauge_adapter: RebenchLog
        command: *MACRO_CMD
        invocations: 3
        benchmarks:
            - Richards:
                extra_args: "130 0 60"
            - DeltaBlue:
                extra_args: "120 0 20000"
            - NBody:
                extra_args: "120 0 500000"
            - JsonSmall:
                extra_args: "120 0 80"
            - GraphSearch:
                extra_args: "250 0 30"
            - PageRank:
                extra_args: "120 0 1400"


    micro-startup:
        gauge_adapter: RebenchLog
        command: *MACRO_CMD
        invocations: 3
        benchmarks:
            - Fannkuch:
                extra_args: "1 0 7"
            - Fibonacci:
                extra_args: "1 0 3"
            - Dispatch:
                extra_args: "1 0 20"
            - Bounce:
                extra_args: "1 0 2"
            - Loop:
                extra_args: "1 0 10"
            - Permute:
                extra_args: "1 0 3"
            - Queens:
                extra_args: "1 0 2"
            - List:
                extra_args: "1 0 2"
            - Recurse:
                extra_args: "1 0 3"
            - Storage:
                extra_args: "1 0 2"
            - Sieve:
                extra_args: "1 0 5"
            - BubbleSort:
                extra_args: "1 0 3"
            - QuickSort:
                extra_args: "1 0 3"
            - Sum:
                extra_args: "1 0 10"
            - Towers:
                extra_args: "1 0 2"
            - TreeSort:
                extra_args: "1 0 1"
            - IntegerLoop:
                extra_args: "1 0 8"
            - FieldLoop:
                extra_args: "1 0 3"
            - WhileLoop:
                extra_args: "1 0 30"
            - Mandelbrot:
                extra_args: "1 0 300"

    micro-steady:
        gauge_adapter: RebenchLog
        command: *MACRO_CMD
        invocations: 3
        benchmarks:
            - Fannkuch:
                extra_args: "14 0 6"
            - Fibonacci:
                extra_args: "15 0 3"
            - Dispatch:
                extra_args: "12 0 20"
            - Bounce:
                extra_args: "22 0 2"
            - Loop:
                extra_args: "14 0 10"
            - Permute:
                extra_args: "16 0 3"
            - Queens:
                extra_args: "13 0 2"
            - List:
                extra_args: "16 0 2"
            - Recurse:
                extra_args: "14 0 3"
            - Storage:
                extra_args: "17 0 2"
            - Sieve:
                extra_args: "18 0 5"
            - BubbleSort:
                extra_args: "16 0 3"
            - QuickSort:
                extra_args: "15 0 3"
            - Sum:
                extra_args: "20 0 10"
            - Towers:
                extra_args: "20 0 2"
            - TreeSort:
                extra_args: "15 0 1"
            - IntegerLoop:
                extra_args: "14 0 8"
            - FieldLoop:
                extra_args: "12 0 3"
            - WhileLoop:
                extra_args: "13 0 30"
            - Mandelbrot:
                extra_args: "110 0 1000"

executors:
    # -b adds the benchmark folfers to the classpath
    GraalSOM-interp:
        path: .
        executable: som
        args: "-G -b -Dgraal.TruffleCompilationExceptionsAreFatal=true"
    GraalSOM-graal:
        path: .
        executable: som
        args: "-b -Dgraal.TruffleCompilationExceptionsAreFatal=true"
        
# define the benchmarks to be executed for a re-executable benchmark run
experiments:
    GraalSOM:
        description: All benchmarks on GraalSOM with Graal
        suites:
            - micro-startup
            - micro-steady
            - macro-startup
            - macro-steady
        executions:
            - GraalSOM-graal

    GraalSOM-interp:
        description: All benchmarks on GraalSOM (Interpreter)
        suites:
            - micro-startup
            - macro-startup
        executions:
            - GraalSOM-interp
 
